# Астероиды и специальные тела в эфемеридах
## Comprehensive анализ доступности

*Generated: 2025-10-29*

---

## Вопрос 1: Есть ли Хирон, Фол и другие астероиды в JPL DE440/441 и EPM2021?

### ❌ Короткий ответ: НЕТ в стандартных файлах

**JPL DE440/DE441** - планетные эфемериды:
- Содержат ТОЛЬКО: Sun, 8 planets, Moon, Earth-Moon Barycenter
- ❌ НЕ содержат: asteroids, centaurs (Chiron, Pholus), trans-Neptunian objects

**EPM2021** - российские планетные эфемериды:
- Содержат ТОЛЬКО: Sun, 8 planets, Moon, EMB, + planet barycenters (Mercury, Venus)
- ❌ НЕ содержат: asteroids, centaurs, TNOs

### ✅ НО есть отдельные файлы астероидов от JPL!

**JPL Small-Body Database** предоставляет:
- `asteroids_de430/` - астероиды для DE430
- `asteroids_de441/` - астероиды для DE441
  - `sb441-n16.bsp` (616 MB) - **16 крупнейших астероидов**
  - `sb441-n373.bsp` (14.1 GB) - **373 астероида**
  - `sb441-n373s.bsp` (937 MB) - короткий span

**Что там есть** (по документации):
- ✅ **Ceres (1 Ceres)** - NAIF ID 2000001
- ✅ **Pallas (2 Pallas)** - NAIF ID 2000002
- ✅ **Vesta (4 Vesta)** - NAIF ID 2000004
- ✅ **Juno (3 Juno)** - NAIF ID 2000003
- ❓ **Chiron (2060 Chiron)** - нужно проверить
- ❓ **Pholus (5145 Pholus)** - нужно проверить

**Временной охват** (из aa_summaries.txt):
- Ceres: 1799-2199 AD (400 years) ✅

---

## Вопрос 2: Chiron и Pholus - где они?

### Chiron (2060 Chiron)
**Классификация**: Centaur (кентавр)
- Орбита между Сатурном и Ураном
- NAIF ID: **2002060** (формат: 2000000 + номер астероида)
- Открыт: 1977
- Особенность: демонстрирует свойства и астероида, и кометы

**Где найти**:
1. ✅ **Swiss Ephemeris** - ID 15, встроено в .se1 файлы
2. ❓ **JPL Horizons System** - можно генерировать индивидуально
3. ❓ **sb441-n373.bsp** - возможно включён (нужна проверка)
4. ❌ **sb441-n16.bsp** - скорее всего НЕТ (только 16 крупнейших)

### Pholus (5145 Pholus)
**Классификация**: Centaur
- Орбита между Сатурном и Нептуном
- NAIF ID: **2005145**
- Открыт: 1992
- Второй открытый кентавр после Хирона

**Где найти**:
1. ✅ **Swiss Ephemeris** - ID 16, встроено
2. ❓ **JPL Horizons** - индивидуальная генерация
3. ❓ **sb441-n373.bsp** - возможно (нужна проверка)
4. ❌ **sb441-n16.bsp** - скорее всего НЕТ

---

## Вопрос 3: Можно ли рассчитать Лунные узлы из положения Луны?

### ✅ ДА, можно рассчитать!

**Лунный узел** = точка пересечения орбиты Луны с эклиптикой

### Теория расчёта:

#### Mean Lunar Node (Средний узел)
Вычисляется из **средних орбитальных элементов** Луны:
```
Longitude of Ascending Node (Ω) = функция времени
Regression period: ~18.6 years (6793.5 days)

Ω(t) = Ω₀ - k × (t - t₀)
где:
  Ω₀ = 125.04° на J2000.0
  k ≈ 0.0529539° per day (регрессия узлов)
```

**Формула** (упрощённая):
```python
def mean_node_longitude(jd):
    # Время от J2000.0 в юлианских столетиях
    T = (jd - 2451545.0) / 36525.0

    # Средняя долгота восходящего узла (градусы)
    Omega = 125.04452 - 1934.136261 * T + 0.0020708 * T**2 + T**3 / 450000

    # Нормализация 0-360°
    Omega = Omega % 360

    return Omega
```

#### True Lunar Node (Истинный узел)
Вычисляется из **мгновенных орбитальных элементов**:
1. Получить позицию и скорость Луны (x, y, z, vx, vy, vz)
2. Вычислить орбитальный угловой момент: **h** = **r** × **v**
3. Линия узлов = пересечение **h** с плоскостью эклиптики
4. Восходящий узел = где Луна пересекает эклиптику с юга на север

**Алгоритм**:
```python
def true_node_from_position(pos, vel):
    # pos, vel в эклиптической системе
    h = cross(pos, vel)  # Угловой момент

    # Вектор восходящего узла (в плоскости эклиптики)
    # n = k × h, где k = [0, 0, 1] (полюс эклиптики)
    n_x = -h[1]
    n_y = h[0]

    # Долгота узла
    longitude = atan2(n_y, n_x)

    # Расстояние (обычно ≈ расстояние Луны)
    distance = norm(pos)

    return longitude, distance
```

### Почему Swiss Eph хранит их в файлах?

**Причины**:
1. **Скорость**: Прямое чтение быстрее вычисления
2. **Точность**: Использует высокоточные астрономические формулы
3. **Консистентность**: Те же алгоритмы, что в научной литературе
4. **Удобство**: Одинаковый API для всех тел

**Точность**:
- Mean Node: аналитическая формула, **очень точная**
- True Node: численная интеграция орбиты, **точная до arcseconds**

---

## Сравнительная таблица источников

### Основные планеты

| Source        | Sun | 8 Planets | Moon | EMB | Format    | Access  |
|---------------|-----|-----------|------|-----|-----------|---------|
| JPL DE440     | ✅  | ✅        | ✅   | ✅  | .440      | Custom  |
| JPL DE441     | ✅  | ✅        | ✅   | ✅  | .441      | Custom  |
| JPL DE431     | ✅  | ✅        | ✅   | ✅  | .431      | Custom  |
| EPM2021       | ✅  | ✅        | ✅   | ✅  | SPICE BSP | calceph |
| Swiss Eph     | ✅  | ✅        | ✅   | ❌  | .se1      | FFI/API |

### Главные астероиды (Main Belt)

| Asteroid      | Swiss Eph | JPL sb441-n16 | JPL sb441-n373 | NAIF ID  |
|---------------|-----------|---------------|----------------|----------|
| 1 Ceres       | ✅ (ID 17)| ✅            | ✅             | 2000001  |
| 2 Pallas      | ✅ (ID 18)| ✅            | ✅             | 2000002  |
| 3 Juno        | ✅ (ID 19)| ✅            | ✅             | 2000003  |
| 4 Vesta       | ✅ (ID 20)| ✅            | ✅             | 2000004  |

### Кентавры (Centaurs)

| Centaur       | Swiss Eph | JPL sb441 | JPL Horizons | NAIF ID  |
|---------------|-----------|-----------|--------------|----------|
| 2060 Chiron   | ✅ (ID 15)| ❓        | ✅           | 2002060  |
| 5145 Pholus   | ✅ (ID 16)| ❓        | ✅           | 2005145  |

### Лунные точки (Lunar Points)

| Point                | Swiss Eph | JPL DE | EPM | Can Calculate? |
|----------------------|-----------|--------|-----|----------------|
| Mean Lunar Node      | ✅ (ID 10)| ❌     | ❌  | ✅ (formula)   |
| True Lunar Node      | ✅ (ID 11)| ❌     | ❌  | ✅ (from pos)  |
| Mean Apogee (Lilith) | ✅ (ID 12)| ❌     | ❌  | ✅ (formula)   |
| Osculating Apogee    | ✅ (ID 13)| ❌     | ❌  | ✅ (from pos)  |

---

## Рекомендации

### Сценарий 1: Нужны только крупные астероиды (Ceres, Pallas, Juno, Vesta)
**Вариант A**: Swiss Ephemeris (✅ recommended)
- ✅ Уже интегрирован
- ✅ Быстрый доступ (FFI)
- ⚠️ Точность: ~84M км vs DE440 (но для астрологии достаточно)

**Вариант B**: Скачать JPL `sb441-n16.bsp` (616 MB)
- ✅ 16 крупнейших астероидов
- ✅ Точность JPL DE441 (высшая)
- ❌ Требует конвертации в .eph
- ❌ Дополнительный файл

### Сценарий 2: Нужны Chiron и Pholus
**Рекомендация**: Swiss Ephemeris (только там есть встроенные)
- ✅ ID 15 (Chiron), ID 16 (Pholus)
- ✅ Готовы к использованию
- ❌ Альтернатив практически нет

**Альтернатива**: JPL Horizons API
- ✅ Можно генерировать индивидуально
- ❌ Требует онлайн-доступ
- ❌ Ручная генерация для каждого тела

### Сценарий 3: Нужны Лунные узлы и Lilith
**Вариант A**: Swiss Ephemeris (recommended)
- ✅ Встроено, готово
- ✅ Одинаковый API
- ✅ Проверенные формулы

**Вариант B**: Рассчитать самостоятельно
- ✅ Полный контроль
- ✅ Не нужен Swiss Eph
- ❌ Требует реализации алгоритмов
- ❌ Нужна валидация точности

### Сценарий 4: Максимальная точность для астероидов
**Рекомендация**: Скачать JPL `sb441-n373.bsp` (14 GB!)
- ✅ 373 астероида
- ✅ Точность JPL DE441
- ❌ Огромный размер
- ❌ Требует конвертации

---

## План действий

### Немедленно (уже готово):
✅ Swiss Ephemeris - 21 тело, включая Chiron, Pholus, узлы, Lilith, 4 астероида

### Опционально:
1. **Скачать sb441-n16.bsp** (616 MB) для точных астероидов
2. **Конвертировать DE431** для сравнения со Swiss Eph (понять источник погрешности)
3. **Реализовать расчёт Лунных узлов** из позиции Луны (для проверки Swiss Eph)

### Не рекомендуется:
❌ **sb441-n373.bsp** (14 GB) - слишком большой для текущих задач

---

## Итоговый ответ на вопросы

### 1. "можете у JPL DE440/441 и EPM2021 есть хирон и другие астероиды в расширенных файлах?"

**Ответ**:
- ✅ **Астероиды (Ceres, Pallas, Juno, Vesta)**: ДА, в отдельных файлах `sb441-n16.bsp` (16 шт) и `sb441-n373.bsp` (373 шт)
- ❓ **Chiron, Pholus**: ВОЗМОЖНО в `sb441-n373.bsp` (нужна проверка), точно есть через JPL Horizons API
- ❌ **В стандартных DE440/441**: НЕТ (только планеты)
- ❌ **В EPM2021**: НЕТ (только планеты)

### 2. "И так же лунные узлы или их можно рассчитывать исходя из положения луны?"

**Ответ**:
- ✅ **Можно рассчитать**: ДА, из орбитальных элементов или позиции/скорости
- ✅ **Mean Node**: простая аналитическая формула (regression ~18.6 years)
- ✅ **True Node**: из векторного произведения r × v (угловой момент)
- ✅ **Точность**: достаточная для астрологии (arcseconds)
- ✅ **Но Swiss Eph удобнее**: готовые данные, проверенные алгоритмы

---

*Recommendation: Используйте Swiss Ephemeris для Chiron, Pholus, узлов и Lilith. Для крупных астероидов при необходимости максимальной точности - скачайте sb441-n16.bsp*
